<!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <title>Block Devices</title>
        <style>
/* From extension vscode.github */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

.vscode-dark img[src$=\#gh-light-mode-only],
.vscode-light img[src$=\#gh-dark-mode-only] {
	display: none;
}

/* From extension vscode.markdown-math */
@font-face{font-family:KaTeX_AMS;font-style:normal;font-weight:400;src:url(fonts/KaTeX_AMS-Regular.woff2) format("woff2"),url(fonts/KaTeX_AMS-Regular.woff) format("woff"),url(fonts/KaTeX_AMS-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Caligraphic;font-style:normal;font-weight:700;src:url(fonts/KaTeX_Caligraphic-Bold.woff2) format("woff2"),url(fonts/KaTeX_Caligraphic-Bold.woff) format("woff"),url(fonts/KaTeX_Caligraphic-Bold.ttf) format("truetype")}@font-face{font-family:KaTeX_Caligraphic;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Caligraphic-Regular.woff2) format("woff2"),url(fonts/KaTeX_Caligraphic-Regular.woff) format("woff"),url(fonts/KaTeX_Caligraphic-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Fraktur;font-style:normal;font-weight:700;src:url(fonts/KaTeX_Fraktur-Bold.woff2) format("woff2"),url(fonts/KaTeX_Fraktur-Bold.woff) format("woff"),url(fonts/KaTeX_Fraktur-Bold.ttf) format("truetype")}@font-face{font-family:KaTeX_Fraktur;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Fraktur-Regular.woff2) format("woff2"),url(fonts/KaTeX_Fraktur-Regular.woff) format("woff"),url(fonts/KaTeX_Fraktur-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Main;font-style:normal;font-weight:700;src:url(fonts/KaTeX_Main-Bold.woff2) format("woff2"),url(fonts/KaTeX_Main-Bold.woff) format("woff"),url(fonts/KaTeX_Main-Bold.ttf) format("truetype")}@font-face{font-family:KaTeX_Main;font-style:italic;font-weight:700;src:url(fonts/KaTeX_Main-BoldItalic.woff2) format("woff2"),url(fonts/KaTeX_Main-BoldItalic.woff) format("woff"),url(fonts/KaTeX_Main-BoldItalic.ttf) format("truetype")}@font-face{font-family:KaTeX_Main;font-style:italic;font-weight:400;src:url(fonts/KaTeX_Main-Italic.woff2) format("woff2"),url(fonts/KaTeX_Main-Italic.woff) format("woff"),url(fonts/KaTeX_Main-Italic.ttf) format("truetype")}@font-face{font-family:KaTeX_Main;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Main-Regular.woff2) format("woff2"),url(fonts/KaTeX_Main-Regular.woff) format("woff"),url(fonts/KaTeX_Main-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Math;font-style:italic;font-weight:700;src:url(fonts/KaTeX_Math-BoldItalic.woff2) format("woff2"),url(fonts/KaTeX_Math-BoldItalic.woff) format("woff"),url(fonts/KaTeX_Math-BoldItalic.ttf) format("truetype")}@font-face{font-family:KaTeX_Math;font-style:italic;font-weight:400;src:url(fonts/KaTeX_Math-Italic.woff2) format("woff2"),url(fonts/KaTeX_Math-Italic.woff) format("woff"),url(fonts/KaTeX_Math-Italic.ttf) format("truetype")}@font-face{font-family:"KaTeX_SansSerif";font-style:normal;font-weight:700;src:url(fonts/KaTeX_SansSerif-Bold.woff2) format("woff2"),url(fonts/KaTeX_SansSerif-Bold.woff) format("woff"),url(fonts/KaTeX_SansSerif-Bold.ttf) format("truetype")}@font-face{font-family:"KaTeX_SansSerif";font-style:italic;font-weight:400;src:url(fonts/KaTeX_SansSerif-Italic.woff2) format("woff2"),url(fonts/KaTeX_SansSerif-Italic.woff) format("woff"),url(fonts/KaTeX_SansSerif-Italic.ttf) format("truetype")}@font-face{font-family:"KaTeX_SansSerif";font-style:normal;font-weight:400;src:url(fonts/KaTeX_SansSerif-Regular.woff2) format("woff2"),url(fonts/KaTeX_SansSerif-Regular.woff) format("woff"),url(fonts/KaTeX_SansSerif-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Script;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Script-Regular.woff2) format("woff2"),url(fonts/KaTeX_Script-Regular.woff) format("woff"),url(fonts/KaTeX_Script-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Size1;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Size1-Regular.woff2) format("woff2"),url(fonts/KaTeX_Size1-Regular.woff) format("woff"),url(fonts/KaTeX_Size1-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Size2;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Size2-Regular.woff2) format("woff2"),url(fonts/KaTeX_Size2-Regular.woff) format("woff"),url(fonts/KaTeX_Size2-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Size3;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Size3-Regular.woff2) format("woff2"),url(fonts/KaTeX_Size3-Regular.woff) format("woff"),url(fonts/KaTeX_Size3-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Size4;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Size4-Regular.woff2) format("woff2"),url(fonts/KaTeX_Size4-Regular.woff) format("woff"),url(fonts/KaTeX_Size4-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Typewriter;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Typewriter-Regular.woff2) format("woff2"),url(fonts/KaTeX_Typewriter-Regular.woff) format("woff"),url(fonts/KaTeX_Typewriter-Regular.ttf) format("truetype")}.katex{text-rendering:auto;font:normal 1.21em KaTeX_Main,Times New Roman,serif;line-height:1.2;text-indent:0}.katex *{-ms-high-contrast-adjust:none!important;border-color:currentColor}.katex .katex-version:after{content:"0.13.24"}.katex .katex-mathml{clip:rect(1px,1px,1px,1px);border:0;height:1px;overflow:hidden;padding:0;position:absolute;width:1px}.katex .katex-html>.newline{display:block}.katex .base{position:relative;white-space:nowrap;width:-webkit-min-content;width:-moz-min-content;width:min-content}.katex .base,.katex .strut{display:inline-block}.katex .textbf{font-weight:700}.katex .textit{font-style:italic}.katex .textrm{font-family:KaTeX_Main}.katex .textsf{font-family:KaTeX_SansSerif}.katex .texttt{font-family:KaTeX_Typewriter}.katex .mathnormal{font-family:KaTeX_Math;font-style:italic}.katex .mathit{font-family:KaTeX_Main;font-style:italic}.katex .mathrm{font-style:normal}.katex .mathbf{font-family:KaTeX_Main;font-weight:700}.katex .boldsymbol{font-family:KaTeX_Math;font-style:italic;font-weight:700}.katex .amsrm,.katex .mathbb,.katex .textbb{font-family:KaTeX_AMS}.katex .mathcal{font-family:KaTeX_Caligraphic}.katex .mathfrak,.katex .textfrak{font-family:KaTeX_Fraktur}.katex .mathtt{font-family:KaTeX_Typewriter}.katex .mathscr,.katex .textscr{font-family:KaTeX_Script}.katex .mathsf,.katex .textsf{font-family:KaTeX_SansSerif}.katex .mathboldsf,.katex .textboldsf{font-family:KaTeX_SansSerif;font-weight:700}.katex .mathitsf,.katex .textitsf{font-family:KaTeX_SansSerif;font-style:italic}.katex .mainrm{font-family:KaTeX_Main;font-style:normal}.katex .vlist-t{border-collapse:collapse;display:inline-table;table-layout:fixed}.katex .vlist-r{display:table-row}.katex .vlist{display:table-cell;position:relative;vertical-align:bottom}.katex .vlist>span{display:block;height:0;position:relative}.katex .vlist>span>span{display:inline-block}.katex .vlist>span>.pstrut{overflow:hidden;width:0}.katex .vlist-t2{margin-right:-2px}.katex .vlist-s{display:table-cell;font-size:1px;min-width:2px;vertical-align:bottom;width:2px}.katex .vbox{align-items:baseline;display:inline-flex;flex-direction:column}.katex .hbox{width:100%}.katex .hbox,.katex .thinbox{display:inline-flex;flex-direction:row}.katex .thinbox{max-width:0;width:0}.katex .msupsub{text-align:left}.katex .mfrac>span>span{text-align:center}.katex .mfrac .frac-line{border-bottom-style:solid;display:inline-block;width:100%}.katex .hdashline,.katex .hline,.katex .mfrac .frac-line,.katex .overline .overline-line,.katex .rule,.katex .underline .underline-line{min-height:1px}.katex .mspace{display:inline-block}.katex .clap,.katex .llap,.katex .rlap{position:relative;width:0}.katex .clap>.inner,.katex .llap>.inner,.katex .rlap>.inner{position:absolute}.katex .clap>.fix,.katex .llap>.fix,.katex .rlap>.fix{display:inline-block}.katex .llap>.inner{right:0}.katex .clap>.inner,.katex .rlap>.inner{left:0}.katex .clap>.inner>span{margin-left:-50%;margin-right:50%}.katex .rule{border:0 solid;display:inline-block;position:relative}.katex .hline,.katex .overline .overline-line,.katex .underline .underline-line{border-bottom-style:solid;display:inline-block;width:100%}.katex .hdashline{border-bottom-style:dashed;display:inline-block;width:100%}.katex .sqrt>.root{margin-left:.27777778em;margin-right:-.55555556em}.katex .fontsize-ensurer.reset-size1.size1,.katex .sizing.reset-size1.size1{font-size:1em}.katex .fontsize-ensurer.reset-size1.size2,.katex .sizing.reset-size1.size2{font-size:1.2em}.katex .fontsize-ensurer.reset-size1.size3,.katex .sizing.reset-size1.size3{font-size:1.4em}.katex .fontsize-ensurer.reset-size1.size4,.katex .sizing.reset-size1.size4{font-size:1.6em}.katex .fontsize-ensurer.reset-size1.size5,.katex .sizing.reset-size1.size5{font-size:1.8em}.katex .fontsize-ensurer.reset-size1.size6,.katex .sizing.reset-size1.size6{font-size:2em}.katex .fontsize-ensurer.reset-size1.size7,.katex .sizing.reset-size1.size7{font-size:2.4em}.katex .fontsize-ensurer.reset-size1.size8,.katex .sizing.reset-size1.size8{font-size:2.88em}.katex .fontsize-ensurer.reset-size1.size9,.katex .sizing.reset-size1.size9{font-size:3.456em}.katex .fontsize-ensurer.reset-size1.size10,.katex .sizing.reset-size1.size10{font-size:4.148em}.katex .fontsize-ensurer.reset-size1.size11,.katex .sizing.reset-size1.size11{font-size:4.976em}.katex .fontsize-ensurer.reset-size2.size1,.katex .sizing.reset-size2.size1{font-size:.83333333em}.katex .fontsize-ensurer.reset-size2.size2,.katex .sizing.reset-size2.size2{font-size:1em}.katex .fontsize-ensurer.reset-size2.size3,.katex .sizing.reset-size2.size3{font-size:1.16666667em}.katex .fontsize-ensurer.reset-size2.size4,.katex .sizing.reset-size2.size4{font-size:1.33333333em}.katex .fontsize-ensurer.reset-size2.size5,.katex .sizing.reset-size2.size5{font-size:1.5em}.katex .fontsize-ensurer.reset-size2.size6,.katex .sizing.reset-size2.size6{font-size:1.66666667em}.katex .fontsize-ensurer.reset-size2.size7,.katex .sizing.reset-size2.size7{font-size:2em}.katex .fontsize-ensurer.reset-size2.size8,.katex .sizing.reset-size2.size8{font-size:2.4em}.katex .fontsize-ensurer.reset-size2.size9,.katex .sizing.reset-size2.size9{font-size:2.88em}.katex .fontsize-ensurer.reset-size2.size10,.katex .sizing.reset-size2.size10{font-size:3.45666667em}.katex .fontsize-ensurer.reset-size2.size11,.katex .sizing.reset-size2.size11{font-size:4.14666667em}.katex .fontsize-ensurer.reset-size3.size1,.katex .sizing.reset-size3.size1{font-size:.71428571em}.katex .fontsize-ensurer.reset-size3.size2,.katex .sizing.reset-size3.size2{font-size:.85714286em}.katex .fontsize-ensurer.reset-size3.size3,.katex .sizing.reset-size3.size3{font-size:1em}.katex .fontsize-ensurer.reset-size3.size4,.katex .sizing.reset-size3.size4{font-size:1.14285714em}.katex .fontsize-ensurer.reset-size3.size5,.katex .sizing.reset-size3.size5{font-size:1.28571429em}.katex .fontsize-ensurer.reset-size3.size6,.katex .sizing.reset-size3.size6{font-size:1.42857143em}.katex .fontsize-ensurer.reset-size3.size7,.katex .sizing.reset-size3.size7{font-size:1.71428571em}.katex .fontsize-ensurer.reset-size3.size8,.katex .sizing.reset-size3.size8{font-size:2.05714286em}.katex .fontsize-ensurer.reset-size3.size9,.katex .sizing.reset-size3.size9{font-size:2.46857143em}.katex .fontsize-ensurer.reset-size3.size10,.katex .sizing.reset-size3.size10{font-size:2.96285714em}.katex .fontsize-ensurer.reset-size3.size11,.katex .sizing.reset-size3.size11{font-size:3.55428571em}.katex .fontsize-ensurer.reset-size4.size1,.katex .sizing.reset-size4.size1{font-size:.625em}.katex .fontsize-ensurer.reset-size4.size2,.katex .sizing.reset-size4.size2{font-size:.75em}.katex .fontsize-ensurer.reset-size4.size3,.katex .sizing.reset-size4.size3{font-size:.875em}.katex .fontsize-ensurer.reset-size4.size4,.katex .sizing.reset-size4.size4{font-size:1em}.katex .fontsize-ensurer.reset-size4.size5,.katex .sizing.reset-size4.size5{font-size:1.125em}.katex .fontsize-ensurer.reset-size4.size6,.katex .sizing.reset-size4.size6{font-size:1.25em}.katex .fontsize-ensurer.reset-size4.size7,.katex .sizing.reset-size4.size7{font-size:1.5em}.katex .fontsize-ensurer.reset-size4.size8,.katex .sizing.reset-size4.size8{font-size:1.8em}.katex .fontsize-ensurer.reset-size4.size9,.katex .sizing.reset-size4.size9{font-size:2.16em}.katex .fontsize-ensurer.reset-size4.size10,.katex .sizing.reset-size4.size10{font-size:2.5925em}.katex .fontsize-ensurer.reset-size4.size11,.katex .sizing.reset-size4.size11{font-size:3.11em}.katex .fontsize-ensurer.reset-size5.size1,.katex .sizing.reset-size5.size1{font-size:.55555556em}.katex .fontsize-ensurer.reset-size5.size2,.katex .sizing.reset-size5.size2{font-size:.66666667em}.katex .fontsize-ensurer.reset-size5.size3,.katex .sizing.reset-size5.size3{font-size:.77777778em}.katex .fontsize-ensurer.reset-size5.size4,.katex .sizing.reset-size5.size4{font-size:.88888889em}.katex .fontsize-ensurer.reset-size5.size5,.katex .sizing.reset-size5.size5{font-size:1em}.katex .fontsize-ensurer.reset-size5.size6,.katex .sizing.reset-size5.size6{font-size:1.11111111em}.katex .fontsize-ensurer.reset-size5.size7,.katex .sizing.reset-size5.size7{font-size:1.33333333em}.katex .fontsize-ensurer.reset-size5.size8,.katex .sizing.reset-size5.size8{font-size:1.6em}.katex .fontsize-ensurer.reset-size5.size9,.katex .sizing.reset-size5.size9{font-size:1.92em}.katex .fontsize-ensurer.reset-size5.size10,.katex .sizing.reset-size5.size10{font-size:2.30444444em}.katex .fontsize-ensurer.reset-size5.size11,.katex .sizing.reset-size5.size11{font-size:2.76444444em}.katex .fontsize-ensurer.reset-size6.size1,.katex .sizing.reset-size6.size1{font-size:.5em}.katex .fontsize-ensurer.reset-size6.size2,.katex .sizing.reset-size6.size2{font-size:.6em}.katex .fontsize-ensurer.reset-size6.size3,.katex .sizing.reset-size6.size3{font-size:.7em}.katex .fontsize-ensurer.reset-size6.size4,.katex .sizing.reset-size6.size4{font-size:.8em}.katex .fontsize-ensurer.reset-size6.size5,.katex .sizing.reset-size6.size5{font-size:.9em}.katex .fontsize-ensurer.reset-size6.size6,.katex .sizing.reset-size6.size6{font-size:1em}.katex .fontsize-ensurer.reset-size6.size7,.katex .sizing.reset-size6.size7{font-size:1.2em}.katex .fontsize-ensurer.reset-size6.size8,.katex .sizing.reset-size6.size8{font-size:1.44em}.katex .fontsize-ensurer.reset-size6.size9,.katex .sizing.reset-size6.size9{font-size:1.728em}.katex .fontsize-ensurer.reset-size6.size10,.katex .sizing.reset-size6.size10{font-size:2.074em}.katex .fontsize-ensurer.reset-size6.size11,.katex .sizing.reset-size6.size11{font-size:2.488em}.katex .fontsize-ensurer.reset-size7.size1,.katex .sizing.reset-size7.size1{font-size:.41666667em}.katex .fontsize-ensurer.reset-size7.size2,.katex .sizing.reset-size7.size2{font-size:.5em}.katex .fontsize-ensurer.reset-size7.size3,.katex .sizing.reset-size7.size3{font-size:.58333333em}.katex .fontsize-ensurer.reset-size7.size4,.katex .sizing.reset-size7.size4{font-size:.66666667em}.katex .fontsize-ensurer.reset-size7.size5,.katex .sizing.reset-size7.size5{font-size:.75em}.katex .fontsize-ensurer.reset-size7.size6,.katex .sizing.reset-size7.size6{font-size:.83333333em}.katex .fontsize-ensurer.reset-size7.size7,.katex .sizing.reset-size7.size7{font-size:1em}.katex .fontsize-ensurer.reset-size7.size8,.katex .sizing.reset-size7.size8{font-size:1.2em}.katex .fontsize-ensurer.reset-size7.size9,.katex .sizing.reset-size7.size9{font-size:1.44em}.katex .fontsize-ensurer.reset-size7.size10,.katex .sizing.reset-size7.size10{font-size:1.72833333em}.katex .fontsize-ensurer.reset-size7.size11,.katex .sizing.reset-size7.size11{font-size:2.07333333em}.katex .fontsize-ensurer.reset-size8.size1,.katex .sizing.reset-size8.size1{font-size:.34722222em}.katex .fontsize-ensurer.reset-size8.size2,.katex .sizing.reset-size8.size2{font-size:.41666667em}.katex .fontsize-ensurer.reset-size8.size3,.katex .sizing.reset-size8.size3{font-size:.48611111em}.katex .fontsize-ensurer.reset-size8.size4,.katex .sizing.reset-size8.size4{font-size:.55555556em}.katex .fontsize-ensurer.reset-size8.size5,.katex .sizing.reset-size8.size5{font-size:.625em}.katex .fontsize-ensurer.reset-size8.size6,.katex .sizing.reset-size8.size6{font-size:.69444444em}.katex .fontsize-ensurer.reset-size8.size7,.katex .sizing.reset-size8.size7{font-size:.83333333em}.katex .fontsize-ensurer.reset-size8.size8,.katex .sizing.reset-size8.size8{font-size:1em}.katex .fontsize-ensurer.reset-size8.size9,.katex .sizing.reset-size8.size9{font-size:1.2em}.katex .fontsize-ensurer.reset-size8.size10,.katex .sizing.reset-size8.size10{font-size:1.44027778em}.katex .fontsize-ensurer.reset-size8.size11,.katex .sizing.reset-size8.size11{font-size:1.72777778em}.katex .fontsize-ensurer.reset-size9.size1,.katex .sizing.reset-size9.size1{font-size:.28935185em}.katex .fontsize-ensurer.reset-size9.size2,.katex .sizing.reset-size9.size2{font-size:.34722222em}.katex .fontsize-ensurer.reset-size9.size3,.katex .sizing.reset-size9.size3{font-size:.40509259em}.katex .fontsize-ensurer.reset-size9.size4,.katex .sizing.reset-size9.size4{font-size:.46296296em}.katex .fontsize-ensurer.reset-size9.size5,.katex .sizing.reset-size9.size5{font-size:.52083333em}.katex .fontsize-ensurer.reset-size9.size6,.katex .sizing.reset-size9.size6{font-size:.5787037em}.katex .fontsize-ensurer.reset-size9.size7,.katex .sizing.reset-size9.size7{font-size:.69444444em}.katex .fontsize-ensurer.reset-size9.size8,.katex .sizing.reset-size9.size8{font-size:.83333333em}.katex .fontsize-ensurer.reset-size9.size9,.katex .sizing.reset-size9.size9{font-size:1em}.katex .fontsize-ensurer.reset-size9.size10,.katex .sizing.reset-size9.size10{font-size:1.20023148em}.katex .fontsize-ensurer.reset-size9.size11,.katex .sizing.reset-size9.size11{font-size:1.43981481em}.katex .fontsize-ensurer.reset-size10.size1,.katex .sizing.reset-size10.size1{font-size:.24108004em}.katex .fontsize-ensurer.reset-size10.size2,.katex .sizing.reset-size10.size2{font-size:.28929605em}.katex .fontsize-ensurer.reset-size10.size3,.katex .sizing.reset-size10.size3{font-size:.33751205em}.katex .fontsize-ensurer.reset-size10.size4,.katex .sizing.reset-size10.size4{font-size:.38572806em}.katex .fontsize-ensurer.reset-size10.size5,.katex .sizing.reset-size10.size5{font-size:.43394407em}.katex .fontsize-ensurer.reset-size10.size6,.katex .sizing.reset-size10.size6{font-size:.48216008em}.katex .fontsize-ensurer.reset-size10.size7,.katex .sizing.reset-size10.size7{font-size:.57859209em}.katex .fontsize-ensurer.reset-size10.size8,.katex .sizing.reset-size10.size8{font-size:.69431051em}.katex .fontsize-ensurer.reset-size10.size9,.katex .sizing.reset-size10.size9{font-size:.83317261em}.katex .fontsize-ensurer.reset-size10.size10,.katex .sizing.reset-size10.size10{font-size:1em}.katex .fontsize-ensurer.reset-size10.size11,.katex .sizing.reset-size10.size11{font-size:1.19961427em}.katex .fontsize-ensurer.reset-size11.size1,.katex .sizing.reset-size11.size1{font-size:.20096463em}.katex .fontsize-ensurer.reset-size11.size2,.katex .sizing.reset-size11.size2{font-size:.24115756em}.katex .fontsize-ensurer.reset-size11.size3,.katex .sizing.reset-size11.size3{font-size:.28135048em}.katex .fontsize-ensurer.reset-size11.size4,.katex .sizing.reset-size11.size4{font-size:.32154341em}.katex .fontsize-ensurer.reset-size11.size5,.katex .sizing.reset-size11.size5{font-size:.36173633em}.katex .fontsize-ensurer.reset-size11.size6,.katex .sizing.reset-size11.size6{font-size:.40192926em}.katex .fontsize-ensurer.reset-size11.size7,.katex .sizing.reset-size11.size7{font-size:.48231511em}.katex .fontsize-ensurer.reset-size11.size8,.katex .sizing.reset-size11.size8{font-size:.57877814em}.katex .fontsize-ensurer.reset-size11.size9,.katex .sizing.reset-size11.size9{font-size:.69453376em}.katex .fontsize-ensurer.reset-size11.size10,.katex .sizing.reset-size11.size10{font-size:.83360129em}.katex .fontsize-ensurer.reset-size11.size11,.katex .sizing.reset-size11.size11{font-size:1em}.katex .delimsizing.size1{font-family:KaTeX_Size1}.katex .delimsizing.size2{font-family:KaTeX_Size2}.katex .delimsizing.size3{font-family:KaTeX_Size3}.katex .delimsizing.size4{font-family:KaTeX_Size4}.katex .delimsizing.mult .delim-size1>span{font-family:KaTeX_Size1}.katex .delimsizing.mult .delim-size4>span{font-family:KaTeX_Size4}.katex .nulldelimiter{display:inline-block;width:.12em}.katex .delimcenter,.katex .op-symbol{position:relative}.katex .op-symbol.small-op{font-family:KaTeX_Size1}.katex .op-symbol.large-op{font-family:KaTeX_Size2}.katex .accent>.vlist-t,.katex .op-limits>.vlist-t{text-align:center}.katex .accent .accent-body{position:relative}.katex .accent .accent-body:not(.accent-full){width:0}.katex .overlay{display:block}.katex .mtable .vertical-separator{display:inline-block;min-width:1px}.katex .mtable .arraycolsep{display:inline-block}.katex .mtable .col-align-c>.vlist-t{text-align:center}.katex .mtable .col-align-l>.vlist-t{text-align:left}.katex .mtable .col-align-r>.vlist-t{text-align:right}.katex .svg-align{text-align:left}.katex svg{fill:currentColor;stroke:currentColor;fill-rule:nonzero;fill-opacity:1;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;display:block;height:inherit;position:absolute;width:100%}.katex svg path{stroke:none}.katex img{border-style:none;max-height:none;max-width:none;min-height:0;min-width:0}.katex .stretchy{display:block;overflow:hidden;position:relative;width:100%}.katex .stretchy:after,.katex .stretchy:before{content:""}.katex .hide-tail{overflow:hidden;position:relative;width:100%}.katex .halfarrow-left{left:0;overflow:hidden;position:absolute;width:50.2%}.katex .halfarrow-right{overflow:hidden;position:absolute;right:0;width:50.2%}.katex .brace-left{left:0;overflow:hidden;position:absolute;width:25.1%}.katex .brace-center{left:25%;overflow:hidden;position:absolute;width:50%}.katex .brace-right{overflow:hidden;position:absolute;right:0;width:25.1%}.katex .x-arrow-pad{padding:0 .5em}.katex .cd-arrow-pad{padding:0 .55556em 0 .27778em}.katex .mover,.katex .munder,.katex .x-arrow{text-align:center}.katex .boxpad{padding:0 .3em}.katex .fbox,.katex .fcolorbox{border:.04em solid;box-sizing:border-box}.katex .cancel-pad{padding:0 .2em}.katex .cancel-lap{margin-left:-.2em;margin-right:-.2em}.katex .sout{border-bottom-style:solid;border-bottom-width:.08em}.katex .angl{border-right:.049em solid;border-top:.049em solid;box-sizing:border-box;margin-right:.03889em}.katex .anglpad{padding:0 .03889em}.katex .eqn-num:before{content:"(" counter(katexEqnNo) ")";counter-increment:katexEqnNo}.katex .mml-eqn-num:before{content:"(" counter(mmlEqnNo) ")";counter-increment:mmlEqnNo}.katex .mtr-glue{width:50%}.katex .cd-vert-arrow{display:inline-block;position:relative}.katex .cd-label-left{display:inline-block;position:absolute;right:calc(50% + .3em);text-align:left}.katex .cd-label-right{display:inline-block;left:calc(50% + .3em);position:absolute;text-align:right}.katex-display{display:block;margin:1em 0;text-align:center}.katex-display>.katex{display:block;text-align:center;white-space:nowrap}.katex-display>.katex>.katex-html{display:block;position:relative}.katex-display>.katex>.katex-html>.tag{position:absolute;right:0}.katex-display.leqno>.katex>.katex-html>.tag{left:0;right:auto}.katex-display.fleqn>.katex{padding-left:2em;text-align:left}body{counter-reset:katexEqnNo mmlEqnNo}

/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

.katex-error {
	color: var(--vscode-editorError-foreground);
}

</style>
        
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
<style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        <style>
.task-list-item { list-style-type: none; } .task-list-item-checkbox { margin-left: -20px; vertical-align: middle; }
</style>
        <style>
#button { display: inline-block; background-color: #FF9800; width: 50px; height: 50px; text-align: center; border-radius: 4px; position: fixed; bottom: 30px; right: 30px; transition: background-color .3s, opacity .5s, visibility .5s; opacity: 0; /*visibility: hidden;*/ z-index: 1000; } #button::after { content: "\f077"; font-family: FontAwesome; font-weight: normal; font-style: normal; font-size: 2em; line-height: 50px; color: #fff; } #button:hover { cursor: pointer; background-color: #333; } #button:active { background-color: #555; } #button.show { opacity: 1; visibility: visible; } #btn-back-to-top { position: fixed; bottom: 20px; right: 20px; display: none; } .to-top { background: white; position: fixed; bottom: 16px; right:32px; width:50px; height:50px; border-radius: 50%; border-color: white; display: flex; align-items: center; justify-content: center; font-size:32px; color:#1f1f1f; text-decoration: none; opacity: 0.5; pointer-events: auto; transition: all .4s; transform: rotate(270deg); } 
</style>
    </head>
    <body class="vscode-body vscode-light">
        <!-- title: Block Devices -->
<p><a href="#" class="to-top">➤</i></a></p>
<ul>
<li><a href="#block-device">Block Device</a>
<ul>
<li><a href="#sector-vs-block">Sector vs block</a></li>
</ul>
</li>
<li><a href="#kernel-internals">Kernel Internals</a>
<ul>
<li><a href="#buffer-and-buffer_head">Buffer and <code>buffer_head</code></a></li>
<li><a href="#bio-structure"><code>bio</code> structure</a>
<ul>
<li><a href="#buffer_head-and-bio"><code>buffer_head</code> and <code>bio</code></a></li>
</ul>
</li>
<li><a href="#request-queue">Request Queue</a></li>
<li><a href="#io-scheduler">I/O Scheduler</a></li>
<li><a href="#old-schedulers">Old schedulers</a>
<ul>
<li><a href="#the-linus-elevator">The Linus Elevator</a></li>
<li><a href="#complete-fair-queuing-cfq-io-scheduler">Complete Fair Queuing (CFQ) I/O scheduler</a></li>
<li><a href="#the-deadline-io-scheduler">The Deadline I/O Scheduler</a></li>
<li><a href="#the-anticipatory-io-scheduler">The Anticipatory I/O Scheduler</a></li>
<li><a href="#noop-io-scheduler">noop I/O Scheduler</a></li>
</ul>
</li>
<li><a href="#new-schedulers">New schedulers</a>
<ul>
<li><a href="#mq-deadline">mq-deadline</a></li>
<li><a href="#bfq">bfq</a></li>
<li><a href="#kyber">kyber</a></li>
<li><a href="#use-cases">Use cases</a></li>
</ul>
</li>
<li><a href="#change-io-scheduler">Change I/O Scheduler</a></li>
<li><a href="#tuning-io-schedulers">Tuning I/O Schedulers</a></li>
</ul>
</li>
</ul>
<h1 id="block-device">Block Device</h1>
<p>Block devices are hardware devices distinguished by the random (that is, not necessarily
sequential) access of fixed-size chunks of data. The fixed-size chunks of data are called
blocks.</p>
<p>The most common block device is a hard disk</p>
<ul>
<li>many other block devices, such as floppy drives, Blu-ray readers, and flash memory.</li>
</ul>
<p>The difference between block device and charactor device comes down to whether the device accesses data randomly. In other words, whether the device can seek to one position from another.</p>
<p>Managing block devices in the kernel requires more care, preparation, and work than
managing character devices. Character devices have only one position—the current
one—whereas block devices must be able to navigate back and forth between any location
on the media. Indeed, the kernel provide an entire subsystem to manage block devices, partly because of the complexicity of block devices, and partly because we want to getting every last drop of performance from block devices.</p>
<h2 id="sector-vs-block">Sector vs block</h2>
<p>Sector is a pyhsical proerpty of a device. Block a software concept in kernel.</p>
<p>The smallest addressable unit on a block device is a <em>sector</em>. Sectors come in various powers
of two, but 512 bytes is the most common size.The sector size is a <strong>physical</strong> property of
the device.</p>
<p>Software imposes its own smallest <strong>logically</strong> addressable unit, which is the <em>block</em>. The kernel performs all disk operations in terms of blocks.</p>
<ul>
<li>Because the device’s smallest addressable unit is the sector, the block size can be no smaller than the sector and must be a multiple of a sector.</li>
<li>The kernel needs the block to be a power of two.</li>
<li>The kernel also requires that a block be no larger than the page size.</li>
<li>Common block sizes are 512 bytes, 1 kilobyte, and 4 kilobytes.</li>
</ul>
<br>
<h1 id="kernel-internals">Kernel Internals</h1>
<p>Overview</p>
<p><img src="images/2022-03-17-09-52-26.png" alt=""></p>
<ol>
<li>A process requests to write a file through the <code>write()</code> system call.</li>
<li>The kernel updates the page cache mapped to the file.</li>
<li>A <code>pdflush</code> kernel thread takes care of flushing the page cache to disk.</li>
<li>The file system layer puts each block buffer together to a bio struct and submits a write request to the block device layer.</li>
<li>The block device layer gets requests from upper layers and performs an I/O elevator operation and puts the requests into the I/O request queue.</li>
<li>A device driver such as SCSI or other device specific drivers will take care of write operation.</li>
<li>A disk device firmware performs hardware operations like seek head, rotation, and data transfer to the sector on the platter.</li>
</ol>
<h2 id="buffer-and-buffer_head">Buffer and <code>buffer_head</code></h2>
<p>When a block is stored in memory — say, after a read or pending a write — it is stored in a
<em>buffer</em>. Each buffer is associated with exactly one block. The buffer serves as the object that
represents a disk block in memory. It is called a <em>buffer head</em> and is
of type <code>struct buffer_head</code>.The <code>buffer_head</code> structure holds all the information that the
kernel needs to manipulate buffers and is defined in <code>&lt;linux/buffer_head.h&gt;</code>.</p>
<pre><code class="language-C++"><div><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">buffer_head</span> {</span>
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> b_state;              <span class="hljs-comment">/* buffer state flags */</span>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">buffer_head</span> *<span class="hljs-title">b_this_page</span>;</span>    <span class="hljs-comment">/* list of page’s buffers */</span>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">page</span> *<span class="hljs-title">b_page</span>;</span>                <span class="hljs-comment">/* associated page */</span>
    <span class="hljs-keyword">sector_t</span> b_blocknr;                 <span class="hljs-comment">/* starting block number */</span>
    <span class="hljs-keyword">size_t</span> b_size;                      <span class="hljs-comment">/* size of mapping */</span>
    <span class="hljs-keyword">char</span> *b_data;                       <span class="hljs-comment">/* pointer to data within the page */</span>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">block_device</span> *<span class="hljs-title">b_bdev</span>;</span>        <span class="hljs-comment">/* associated block device */</span>
    <span class="hljs-keyword">bh_end_io_t</span> *b_end_io;              <span class="hljs-comment">/* I/O completion */</span>
    <span class="hljs-keyword">void</span> *b_private;                    <span class="hljs-comment">/* reserved for b_end_io */</span>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">list_head</span> <span class="hljs-title">b_assoc_buffers</span>;</span>   <span class="hljs-comment">/* associated mappings */</span>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">address_space</span> *<span class="hljs-title">b_assoc_map</span>;</span>  <span class="hljs-comment">/* associated address space */</span>
    <span class="hljs-keyword">atomic_t</span> b_count;                   <span class="hljs-comment">/* use count */</span>
};
</div></code></pre>
<p>The <code>b_state</code> field specifies the state of this particular buffer. It can be one or more of
the flags defined in the <code>bh_state_bits</code> enumeration in &lt;linux/buffer_head.h&gt;.</p>
<p>The <code>b_count</code> field is the buffer’s usage count. Before manipulating a buffer head, you must increment its reference count via get_bh() to ensure that the buffer head is not deallocated out from under you.</p>
<p>The purpose of a buffer head is to describe the mapping between the on-disk block
and the physical in-memory buffer. Acting as a descriptor of this buffer-to-block mapping is the data structure’s only role in the kernel.</p>
<ul>
<li>The physical block on disk to which a given buffer corresponds is the <code>b_blocknr</code>.</li>
<li>The physical page in memory to which a given buffer corresponds is the page pointed
to by <code>b_page</code>.
<ul>
<li><code>b_data</code> is a pointer directly to the block (that exists somewhere in <code>b_page</code>), which is <code>b_size</code> bytes in length. Therefore, the block is located in memory starting at address b_data and ending at address <code>(b_data + b_size)</code>.</li>
</ul>
</li>
</ul>
<h2 id="bio-structure"><code>bio</code> structure</h2>
<p>The basic container for block I/O within the kernel is the bio structure, defined in <code>&lt;linux/bio.h&gt;</code>. Each block I/O request is represented by a <code>bio</code> structure.</p>
<p>This structure represent a block I/O request that are in flight (active) as a list of <em>segments</em>.</p>
<ul>
<li>A segment is a chunk of a buffer that is contiguous in memory.
<ul>
<li>Each request is composed of one or more blocks, which are stored in an array of <code>bio_vec</code> structures (<code>bi_io_vec</code> field).</li>
</ul>
</li>
<li>the <code>bio</code> structure provides the capability for the kernel to perform block I/O operations of even a single buffer from multiple locations in memory.
<ul>
<li>Vector I/O such as this is called <em>scatter-gather I/O</em>.</li>
<li>Eg. With this feature, drivers implementing a Redundant Array of Inexpensive Disks (RAID). It can take a single <code>bio</code> structure and split it among the multiple hard drives in the RAID array. All the RAID driver needs to do is copy the <code>bio</code> structure and update the <code>bi_idx</code> field to point to where the individual drive should start its operation.</li>
</ul>
</li>
</ul>
<pre><code class="language-C++"><div><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">bio</span> {</span>
    <span class="hljs-keyword">sector_t</span> bi_sector;         <span class="hljs-comment">/* associated sector on disk */</span>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">bio</span> *<span class="hljs-title">bi_next</span>;</span>        <span class="hljs-comment">/* list of requests */</span>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">block_device</span> *<span class="hljs-title">bi_bdev</span>;</span> <span class="hljs-comment">/* associated block device */</span>
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> bi_flags;     <span class="hljs-comment">/* status and command flags */</span>
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> bi_rw;        <span class="hljs-comment">/* read or write? */</span>
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">short</span> bi_vcnt;     <span class="hljs-comment">/* number of bio_vecs off */</span>
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">short</span> bi_idx;      <span class="hljs-comment">/* current index in bi_io_vec */</span>
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">short</span> bi_phys_segments; <span class="hljs-comment">/* number of segments */</span>
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> bi_size;       <span class="hljs-comment">/* I/O count */</span>
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> bi_seg_front_size; <span class="hljs-comment">/* size of first segment */</span>
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> bi_seg_back_size; <span class="hljs-comment">/* size of last segment */</span>
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> bi_max_vecs;   <span class="hljs-comment">/* maximum bio_vecs possible */</span>
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> bi_comp_cpu;   <span class="hljs-comment">/* completion CPU */</span>
    <span class="hljs-keyword">atomic_t</span> bi_cnt;            <span class="hljs-comment">/* usage counter */</span>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">bio_vec</span> *<span class="hljs-title">bi_io_vec</span>;</span>  <span class="hljs-comment">/* bio_vec list */</span>
    <span class="hljs-keyword">bio_end_io_t</span> *bi_end_io;    <span class="hljs-comment">/* I/O completion method */</span>
    <span class="hljs-keyword">void</span> *bi_private;           <span class="hljs-comment">/* owner-private method */</span>
    <span class="hljs-keyword">bio_destructor_t</span> *bi_destructor; <span class="hljs-comment">/* destructor method */</span>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">bio_vec</span> <span class="hljs-title">bi_inline_vecs</span>[0];</span> <span class="hljs-comment">/* inline bio vectors */</span>
};
</div></code></pre>
<p>The most important fields are <code>bi_io_vec</code>, <code>bi_vcnt</code>, and <code>bi_idx</code>. Figure 14.2 shows the
relationship between the <code>bio</code> structure and its fields.</p>
<p><img src="images/2022-02-15-20-45-18.png" alt=""></p>
<p>Each <code>bio_vec</code> is treated as a vector of the form <code>&lt;page, offset, len&gt;</code>, which describes a specific segment. The full array of these vectors describes the entire buffer.</p>
<p>The <code>bio_vec</code> structure is defined in <code>&lt;linux/bio.h&gt;</code>:</p>
<pre><code class="language-C++"><div><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">bio_vec</span> {</span>
    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">page</span> *<span class="hljs-title">bv_page</span>;</span>   <span class="hljs-comment">/* pointer to the physical page on which this buffer resides */</span>
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> bv_len;    <span class="hljs-comment">/* the length in bytes of this buffer */</span>
    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">int</span> bv_offset; <span class="hljs-comment">/* the byte offset within the page where the buffer resides */</span>
};
</div></code></pre>
<h3 id="buffer_head-and-bio"><code>buffer_head</code> and <code>bio</code></h3>
<ul>
<li>The <code>bio</code> structure represents an I/O operation, which may include one or more pages in memory.</li>
<li>the <code>buffer_head</code> structure represents a single buffer, which describes a single block on the disk.</li>
</ul>
<p><code>buffer_head</code>s function as descriptors, mapping disk blocks to pages. The <code>bio</code> structure does not contain any information about the state of a buffer—it is simply an array of vectors describing one or more segments of data for a single block I/O operation, plus related information.</p>
<ul>
<li>In the current setup, the buffer_head structure is still needed to contain information about buffers
while the bio structure describes in-flight I/O.</li>
<li>Keeping the two structures separate enables each to remain as small as possible.</li>
</ul>
<h2 id="request-queue">Request Queue</h2>
<p>Block devices maintain request queues to store their pending block I/O requests.The
request queue is represented by the <code>request_queue</code> structure and is defined in
<code>&lt;linux/blkdev.h&gt;</code>.</p>
<ul>
<li>Kernel adds the request to the queue</li>
<li>the block device driver grabs the request from the head of queue, and submits it to the block device.</li>
</ul>
<p>The request queue contains a doubly linked list of requests, of type <code>struct request</code>, also defined in <code>&lt;linux/blkdev.h&gt;</code>.</p>
<ul>
<li>Each request can be composed of more than one <code>bio</code> structure because individual requests can operate on multiple consecutive disk blocks.</li>
</ul>
<h2 id="io-scheduler">I/O Scheduler</h2>
<p>the kernel does not issue block I/O requests to the disk in the order they are received or as soon as they are received because the slow disk seek (each seek - positioning the hard disk's head at the specific block - takes milliseconds).</p>
<p>Kernel uses I/O Scheduler (a totally differnet kernel sub-system than process scheduler) to manage a block device's request queue with the goal of reducing seeks. It decides the order
of requests in the queue and at what time each request is dispatched to the block device. This is critical in whole system's performance.</p>
<p>I/O schedulers perform two primary actions to minimize seeks: merging and sorting.</p>
<ul>
<li>Merging is the coalescing of two or more requests into one.</li>
<li>The entire request queue is kept sorted, sector-wise, so that all seeking activity along the queue moves (as much as possible) sequentially in one direction over the sectors of the hard disk.
<ul>
<li>Because of this similarity, I/O schedulers (or sometimes just their sorting algorithm) are called <em>elevators</em>.</li>
</ul>
</li>
</ul>
<h2 id="old-schedulers">Old schedulers</h2>
<h3 id="the-linus-elevator">The Linus Elevator</h3>
<p>It was the default I/O scheduler in 2.4 (<strong>deprecated in 2.6</strong>). The Linus elevator is implemented in <code>&lt;block/elevator.c&gt;</code>.</p>
<p>When a new request is added to the queue, below 4 steps are done in order:</p>
<ol>
<li>If a request to an adjacent on-disk sector is in the queue, the existing request and
the new request merge into a single request.</li>
<li>If a request in the queue is sufficiently old, the new request is inserted at the tail of
the queue to prevent starvation of the other, older, requests.</li>
<li>If a suitable location sector-wise is in the queue, the new request is inserted there.
This keeps the queue sorted by physical location on disk.</li>
<li>Finally, if no such suitable insertion point exists, the request is inserted at the tail of
the queue.</li>
</ol>
<p>Unfortunately, the step 2 “age” check is not efficient. It does not provide any real
attempt to service requests in a given timeframe; it merely stops insertion-sorting requests
after a suitable delay.This improves latency but can still lead to request starvation, which
was the big must-fix of the 2.4 I/O scheduler.</p>
<h3 id="complete-fair-queuing-cfq-io-scheduler">Complete Fair Queuing (CFQ) I/O scheduler</h3>
<p>Code in <code>block/cfq-iosched.c</code>, It is now the default I/O scheduler in Linux (not true anymore after v5 kernel).</p>
<p>The CFQ I/O scheduler assigns incoming I/O requests to specific queues based on
the process originating the I/O request, ie. there is one queue for each process submitting I/O. Within each queue, requests are coalesced with adjacent requests and insertion sorted.</p>
<p>The CFQ I/O scheduler then services the queues round robin, plucking a configurable
number of requests (by default, four) from each queue before continuing on to the
next.This provides fairness at a per-process level, assuring that each process receives a fair
slice of the disk’s bandwidth.</p>
<p>It is recommended for desktop workloads, although it performs reasonably well in nearly all
workloads without any pathological corner cases.</p>
<h3 id="the-deadline-io-scheduler">The Deadline I/O Scheduler</h3>
<p>Each request is associated with an expiration time. By default, the expiration time is 500 milliseconds in the future for read requests and 5 seconds in the future for write requests.</p>
<p><img src="images/2022-02-15-23-06-13.png" alt=""></p>
<p>it maintains a request queue sorted by physical location on disk. It calls this queue the sorted queue. It performs merging and insertion on this queue.</p>
<p>It also maintains two FIFO queue. Read requests are sorted into a read FIFO queue,
and write requests are inserted into a write FIFO queue. Both FIFO queue are basically time sorted.</p>
<p>The scheduler decides on the next request by first deciding which queue to use.</p>
<ul>
<li>If the request at the head of either the write FIFO queue or the read FIFO queue expires, it serves them first.</li>
<li>The it serves requests from sorted queue.</li>
</ul>
<p>The Deadline I/O Scheduler prevents request starvation. Because read requests are given a substantially
smaller expiration value than write requests, the Deadline I/O scheduler also works to
ensure that write requests do not starve read requests.</p>
<p>Code in <code>block/deadline-iosched.c</code>.</p>
<h3 id="the-anticipatory-io-scheduler">The Anticipatory I/O Scheduler</h3>
<p>Anticipatory I/O scheduler starts with the Deadline I/O scheduler as its base, with three queues and expirations for each queue. The major change is the addition of an anticipation heuristic.</p>
<p>When a read request is issued, it is handled as usual, within its usual expiration period. After the request is submitted, however, the Anticipatory I/O scheduler does not immediately seek back and return to handling other requests. Instead, it does absolutely nothing for a few milliseconds (configurable,  default is six milliseconds).If the request comes in the waiting period, the disk head is in the correct location, and the request is serviced very quickly.</p>
<p>It is ideal for servers (like Apache web server), although it
performs poorly on certain workloads involving databases.</p>
<p>Code in <code>block/as-iosched.c</code></p>
<h3 id="noop-io-scheduler">noop I/O Scheduler</h3>
<p>Performs merging of I/O requests but no sorting. Good for random access devices (flash, ramdisk, etc) and for devices that sort I/O requests such as advanced storage controllers.</p>
<p>Code in <code>block/noop-iosched.c</code></p>
<h2 id="new-schedulers">New schedulers</h2>
<p>In Red Hat Enterprise Linux 8 (kernel v5), block devices support only multi-queue scheduling. This enables the block layer performance to scale well with fast solid-state drives (SSDs) and multi-core systems.</p>
<p>The traditional, single-queue schedulers, which were available in Red Hat Enterprise Linux 7 and earlier versions, have been removed.</p>
<h3 id="mq-deadline">mq-deadline</h3>
<p>similar to deadline</p>
<h3 id="bfq">bfq</h3>
<p>bfq is based on cfq code. It does not grant the disk to each process for a fixed time slice but assigns a budget measured in number of sectors to the process.</p>
<p>The bfq scheduler ensures that a single application is never using all of the bandwidth. In effect, the storage device is always as responsive as if it was idle. In its default configuration, bfq focuses on delivering the lowest latency rather than achieving the maximum throughput.</p>
<p>It targets desktop systems and interactive tasks. This scheduler is suitable while copying large files and the system does not become unresponsive in this case.</p>
<h3 id="kyber">kyber</h3>
<p>The scheduler tunes itself to achieve a latency goal by calculating the latencies of every I/O request submitted to the block I/O layer. You can configure the target latencies for read, in the case of cache-misses, and synchronous write requests.</p>
<p>This scheduler is suitable for fast devices, for example NVMe, SSD, or other low latency devices.</p>
<h3 id="use-cases">Use cases</h3>
<p>Depending on the task that your system performs, the following disk schedulers are recommended as a baseline prior to any analysis and tuning tasks:</p>
<table>
<thead>
<tr>
<th>Use case</th>
<th>Disk scheduler</th>
</tr>
</thead>
<tbody>
<tr>
<td>Traditional HDD with a SCSI interface</td>
<td>Use mq-deadline or bfq.</td>
</tr>
<tr>
<td>High-performance SSD or a CPU-bound system with fast storage</td>
<td>Use none, especially when running enterprise applications. Alternatively, use kyber.</td>
</tr>
<tr>
<td>Desktop or interactive tasks</td>
<td>Use bfq.</td>
</tr>
<tr>
<td>Virtual guest</td>
<td>Use mq-deadline. With a host bus adapter (HBA) driver that is multi-queue capable, use none.</td>
</tr>
</tbody>
</table>
<h2 id="change-io-scheduler">Change I/O Scheduler</h2>
<p>By default, block devices use the Complete Fair Queuing I/O scheduler.This can be overridden via the boot-time option <code>elevator=foo</code> on the kernel command line, where <code>foo</code> is a valid and enabled I/O Scheduler.</p>
<p>A second way to change the I/O scheduler is on the fly. For example, you can determine which I/O scheduler is being used by looking at the /sys/block/[device]/queue/scheduler file, where [device] is the name of the device. For example, on my laptop, the command</p>
<pre><code class="language-bash"><div>root@laytonjb-laptop:~<span class="hljs-comment"># cat /sys/block/sdb/queue/scheduler</span>
noop anticipatory deadline [cfq] 
</div></code></pre>
<p>shows that the current I/O scheduler (in square brackets) is cfq. To change the scheduler, just echo the name of the desired scheduler:</p>
<pre><code class="language-bash"><div>root@laytonjb-laptop:~<span class="hljs-comment"># echo deadline &gt; /sys/block/sdb/queue/scheduler</span>
root@laytonjb-laptop:~<span class="hljs-comment"># cat /sys/block/sdb/queue/scheduler</span>
noop anticipatory [deadline] cfq 
</div></code></pre>
<h2 id="tuning-io-schedulers">Tuning I/O Schedulers</h2>
<p>Each I/O scheduler has a default set of tunable options that may be adjusted to help improve performance or fair sharing for your particular use case. The following kernel documentation covers these per-I/O scheduler tunable options:</p>
<p>deadline (and mq-deadline) <a href="https://www.kernel.org/doc/Documentation/block/deadline-iosched.txt">deadline-iosched.txt</a></p>
<p>cfq <a href="https://www.kernel.org/doc/Documentation/block/cfq-iosched.txt">cfq-iosched.txt</a></p>
<p>bfq <a href="https://www.kernel.org/doc/Documentation/block/bfq-iosched.txt">bfq-iosched.txt</a></p>
<p>kyber <a href="https://www.kernel.org/doc/Documentation/block/kyber-iosched.txt">kyber-iosched.txt</a></p>

        
        
    </body>
    </html>